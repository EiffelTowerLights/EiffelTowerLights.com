<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Luces Torre Eiffel</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

    body {
      background-color: #1c1c2b;
      color: white;
      font-family: 'Segoe UI', sans-serif;
      text-align: center;
      margin: 0;
      padding: 40px 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .timer {
      font-family: 'Share Tech Mono', monospace;
      font-size: 3rem;
      font-weight: bold;
      color: white;
      text-shadow: 0 0 6px white;
      margin: 10px 0 20px;
      letter-spacing: 2px;
    }

    .red-outline {
      color: white;
      -webkit-text-stroke: 0.8px #ff3c3c;
      text-shadow: none;
    }

    .subtext {
      font-size: 1rem;
      max-width: 600px;
      margin-bottom: 15px;
      color: white;
    }

    #langSelector {
      margin-top: 20px;
      padding: 8px;
      font-size: 1rem;
      border-radius: 4px;
      border: none;
      background-color: #fff;
      color: #1c1c2b;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="mainTitle" class="timer red-outline">Cargando...</div>
  <div id="sunsetClock" class="timer red-outline" style="display: none;">--:--</div>
  <div id="infoBox" class="subtext" style="display: none;"></div>
  <div id="countdown" class="timer red-outline" style="display: none;">--:--:--</div>
  <div id="postCountdownNote" class="subtext" style="display: none;"></div>

  <select id="langSelector">
    <option value="auto">ğŸŒ Idioma automÃ¡tico</option>
    <option value="es">EspaÃ±ol</option>
    <option value="en">English</option>
    <option value="fr">FranÃ§ais</option>
    <option value="zh">ä¸­æ–‡</option>
  </select>

  <script>
    const translations = {
      es: {
        beforeTitle: "Hora estimada del encendido de la Torre Eiffel",
        afterTitle: "PrÃ³ximo espectÃ¡culo de destellos",
        beforeShow: "El espectÃ¡culo de destellos comenzarÃ¡ cada hora en punto despuÃ©s del encendido de la Torre Eiffel hasta la 1:00.",
        afterShow: "El espectÃ¡culo de destellos comenzarÃ¡ a la siguiente hora en punto y durarÃ¡ 5 minutos.",
        loading: "Cargando hora estimada..."
      },
      en: {
        beforeTitle: "Estimated lighting time of the Eiffel Tower",
        afterTitle: "Next sparkling show",
        beforeShow: "The sparkling show begins every hour on the hour after the Eiffel Tower lights up until 1:00â€¯am.",
        afterShow: "The next sparkling show will begin at the next full hour and last 5 minutes.",
        loading: "Loading estimated time..."
      },
      fr: {
        beforeTitle: "Heure estimÃ©e dâ€™allumage de la Tour Eiffel",
        afterTitle: "Prochain spectacle de scintillement",
        beforeShow: "Le spectacle de scintillement commence Ã  chaque heure pile aprÃ¨s lâ€™allumage de la Tour Eiffel, jusquâ€™Ã  1h00.",
        afterShow: "Le prochain spectacle de scintillement commencera Ã  lâ€™heure pile suivante et durera 5 minutes.",
        loading: "Chargement de l'heure estimÃ©e..."
      },
      zh: {
        beforeTitle: "åŸƒè²å°”é“å¡”é¢„è®¡äº®ç¯æ—¶é—´",
        afterTitle: "ä¸‹ä¸€åœºç¯å…‰ç§€",
        beforeShow: "ç¯å…‰ç§€å°†åœ¨åŸƒè²å°”é“å¡”ç‚¹äº®åæ¯å°æ—¶æ•´ç‚¹å¼€å§‹ï¼ŒæŒç»­è‡³å‡Œæ™¨1ç‚¹ã€‚",
        afterShow: "ä¸‹ä¸€åœºç¯å…‰ç§€å°†åœ¨ä¸‹ä¸€ä¸ªæ•´ç‚¹å¼€å§‹ï¼ŒæŒç»­5åˆ†é’Ÿã€‚",
        loading: "æ­£åœ¨åŠ è½½é¢„è®¡æ—¶é—´..."
      }
    };

    let sunsetTimeParis = null;
    let lastShowHour = 1;
    let currentLang = "es";

    function translateUI(langCode) {
      const autoLang = navigator.language.slice(0, 2);
      const lang = langCode === "auto" ? autoLang : langCode;
      currentLang = translations[lang] ? lang : "es";
      const t = translations[currentLang];
      document.getElementById("mainTitle").textContent = t.loading;
    }

    function formatParisTime(date) {
      return date.toLocaleTimeString("fr-FR", {
        timeZone: "Europe/Paris",
        hour: '2-digit',
        minute: '2-digit'
      });
    }

    function updateUI() {
      if (!sunsetTimeParis) return;

      const now = new Date();
      const parisNow = new Date(now.toLocaleString("en-US", { timeZone: "Europe/Paris" }));
      const t = translations[currentLang];
      const isBeforeShow = parisNow < sunsetTimeParis;

      document.getElementById("mainTitle").textContent = isBeforeShow
        ? t.beforeTitle
        : t.afterTitle;

      document.getElementById("sunsetClock").textContent = formatParisTime(sunsetTimeParis);
      document.getElementById("sunsetClock").style.display = isBeforeShow ? "block" : "none";

      document.getElementById("infoBox").innerHTML = isBeforeShow ? t.beforeShow : "";
      document.getElementById("infoBox").style.display = isBeforeShow ? "block" : "none";

      document.getElementById("countdown").style.display = !isBeforeShow ? "block" : "none";
      document.getElementById("postCountdownNote").style.display = !isBeforeShow ? "block" : "none";
      document.getElementById("postCountdownNote").textContent = !isBeforeShow ? t.afterShow : "";

      if (!isBeforeShow) updateCountdown(parisNow);
    }

    function updateCountdown(parisNow) {
      let nextShow = new Date(sunsetTimeParis);
      nextShow.setMinutes(0, 0, 0);
      while (parisNow >= nextShow && nextShow.getHours() < lastShowHour) {
        nextShow.setHours(nextShow.getHours() + 1);
      }

      if (nextShow.getHours() > lastShowHour) {
        document.getElementById("countdown").textContent =
          currentLang === "zh"
            ? "ä»Šæ—¥ç¯å…‰ç§€å·²ç»“æŸ"
            : currentLang === "fr"
              ? "Dernier spectacle terminÃ© pour aujourd'hui"
              : currentLang === "en"
                ? "Last show finished for today"
                : "Ãšltimo espectÃ¡culo finalizado por hoy";
        document.getElementById("postCountdownNote").style.display = "none";
        return;
      }

      const diff = nextShow - parisNow;
      const hrs = String(Math.floor(diff / 3600000)).padStart(2, "0");
      const mins = String(Math.floor((diff % 3600000) / 60000)).padStart(2, "0");
      const secs = String(Math.floor((diff % 60000) / 1000)).padStart(2, "0");

      document.getElementById("countdown").textContent = `${hrs}:${mins}:${secs}`;
    }

    function fetchSunsetTime() {
      fetch("https://api.sunrise-sunset.org/json?lat=48.8566&lng=2.3522&formatted=0")
        .then(res => res.json())
        .then(data => {
          const sunsetUTC = new Date(data.results.sunset);
          const sunsetParis = new Date(sunsetUTC.toLocaleString("en-US", { timeZone: "Europe/Paris" }));
          sunsetParis.setMinutes(sunsetParis.getMinutes() + 10);
          sunsetTimeParis = sunsetParis;
          updateUI();
        });
    }

    document.getElementById("langSelector").addEventListener("change", (e) => {
      translateUI(e.target.value);
      updateUI();
    });

    translateUI("auto");
    fetchSunsetTime();
    setInterval(updateUI, 1000);
  </script>
</body>
</html>
