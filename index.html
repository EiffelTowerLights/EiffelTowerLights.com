<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Luces Torre Eiffel</title>
  <style>
    body {
      background: linear-gradient(to top, #1c1c2b, #2e2e48);
      color: #fff;
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 100vh;
      margin: 0;
      text-align: center;
      padding: 30px;
    }
    h1 {
      font-size: 2rem;
      margin-top: 30px;
    }
    #countdown {
      font-size: 3rem;
      font-weight: bold;
      margin: 20px 0;
    }
    .subtext, #infoBox {
      font-size: 1rem;
      margin-bottom: 15px;
      max-width: 500px;
    }
    #langSelector {
      margin-top: 10px;
      padding: 8px;
      font-size: 1rem;
      border-radius: 4px;
      border: none;
      background-color: #fff;
      color: #1c1c2b;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1 id="headline">Pr√≥ximo encendido de luces üóº</h1>

  <div id="infoBox" style="display:none;"></div>
  <div id="countdown" style="display:none;">--:--:--</div>
  <div class="subtext" id="subtext">
    Cada hora despu√©s del anochecer, durante 5 minutos.
  </div>

  <select id="langSelector">
    <option value="auto">üåê Idioma autom√°tico</option>
    <option value="es">Espa√±ol</option>
    <option value="en">English</option>
    <option value="fr">Fran√ßais</option>
    <option value="de">Deutsch</option>
    <option value="it">Italiano</option>
    <option value="pt">Portugu√™s</option>
    <option value="ja">Êó•Êú¨Ë™û</option>
  </select>

  <script>
    const translations = {
      es: {
        title: "Pr√≥ximo encendido de luces üóº",
        note: "Cada hora despu√©s del anochecer, durante 5 minutos.",
        info: (sunset, duration) => `üåá El primer espect√°culo comenzar√° alrededor de las ${sunset}.<br>√öltimo espect√°culo a la ${duration === 10 ? "1:00" : "00:00"} (duraci√≥n especial: ${duration} minutos).`
      },
      en: {
        title: "Next Eiffel Tower light show üóº",
        note: "Every hour after nightfall, lasting 5 minutes.",
        info: (sunset, duration) => `üåá The first show will begin around ${sunset}.<br>Last show at ${duration === 10 ? "1:00‚ÄØam" : "Midnight"} (duration: ${duration} min).`
      },
      fr: {
        title: "Prochaine illumination de la Tour Eiffel üóº",
        note: "Chaque heure apr√®s la tomb√©e de la nuit, pendant 5 minutes.",
        info: (sunset, duration) => `üåá Le premier spectacle commencera vers ${sunset}.<br>Dernier √† ${duration === 10 ? "1h00" : "minuit"} (dur√©e : ${duration}‚ÄØmin).`
      }
      // Puedes a√±adir m√°s idiomas si quieres
    };

    let sunsetTimeParis = null;
    let lastShowHour = 0;
    let showDuration = 5;
    let currentLang = "es";

    function translateUI(langCode) {
      const autoLang = navigator.language.slice(0, 2);
      const lang = langCode === "auto" ? autoLang : langCode;
      currentLang = translations[lang] ? lang : "en";
      const strings = translations[currentLang];
      document.getElementById("headline").textContent = strings.title;
      document.getElementById("subtext").textContent = strings.note;
    }

    function formatTimeToParis(date) {
      return date.toLocaleTimeString("fr-FR", {
        timeZone: "Europe/Paris",
        hour: '2-digit',
        minute: '2-digit',
      });
    }

    function updateView() {
      const now = new Date();
      const parisNow = new Date(now.toLocaleString("en-US", { timeZone: "Europe/Paris" }));
      const infoBox = document.getElementById("infoBox");
      const countdownBox = document.getElementById("countdown");

      if (!sunsetTimeParis) return;

      const info = translations[currentLang].info(formatTimeToParis(sunsetTimeParis), showDuration);

      if (parisNow < sunsetTimeParis) {
        infoBox.innerHTML = info;
        infoBox.style.display = "block";
        countdownBox.style.display = "none";
      } else {
        infoBox.style.display = "none";
        countdownBox.style.display = "block";
        updateCountdown(parisNow);
      }
    }

    function updateCountdown(parisNow) {
      let nextShow = new Date(sunsetTimeParis);
      nextShow.setMinutes(0, 0, 0);
      while (parisNow >= nextShow && nextShow.getHours() < lastShowHour) {
        nextShow.setHours(nextShow.getHours() + 1);
      }

      if (nextShow.getHours() > lastShowHour) {
        document.getElementById("countdown").textContent = "üéâ √öltimo espect√°culo finalizado por hoy";
        return;
      }

      const diff = nextShow - parisNow;
      const hrs = String(Math.floor(diff / 3600000)).padStart(2, "0");
      const mins = String(Math.floor((diff % 3600000) / 60000)).padStart(2, "0");
      const secs = String(Math.floor((diff % 60000) / 1000)).padStart(2, "0");

      document.getElementById("countdown").textContent = `${hrs}:${mins}:${secs}`;
    }

    function fetchSunsetTime() {
      fetch("https://api.sunrise-sunset.org/json?lat=48.8566&lng=2.3522&formatted=0")
        .then(res => res.json())
        .then(data => {
          const sunsetUTC = new Date(data.results.sunset);
          const sunsetParis = new Date(sunsetUTC.toLocaleString("en-US", { timeZone: "Europe/Paris" }));
          sunsetParis.setMinutes(sunsetParis.getMinutes() + 10); // Esperar 10 minutos tras anochecer
          sunsetTimeParis = sunsetParis;
          const month = sunsetParis.getMonth();
          lastShowHour = ([5, 6, 7].includes(month)) ? 1 : 0; // Junio-agosto: hasta la 1:00
          showDuration = lastShowHour === 1 ? 10 : 5;
          updateView();
        });
    }

    document.getElementById("langSelector").addEventListener("change", (e) => {
      translateUI(e.target.value);
      updateView();
    });

    translateUI("auto");
    fetchSunsetTime();
    setInterval(updateView, 1000);
  </script>
</body>
</html>
